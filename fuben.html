<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OrbitGuard: 面向航天遥感目标检测模型的可靠性评估与漏洞对抗系统</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css" rel="stylesheet">
<style>
body {
font-family: 'Space Grotesk', sans-serif;
background: linear-gradient(135deg, #1a1f35 0%, #283045 100%);
color: #fff;
}
@keyframes fade-in {
from {
opacity: 0;
transform: translateY(20px);
}
to {
opacity: 1;
transform: translateY(0);
}
}
.animate-fade-in {
animation: fade-in 0.3s ease-out forwards;
}
.tech-border {
position: relative;
overflow: hidden;
border: 1px solid rgba(59, 130, 246, 0.3);
}
.tech-card {
background: rgba(255, 255, 255, 0.05);
backdrop-filter: blur(10px);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.tech-glow {
box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
}
</style>
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#3b82f6',
secondary: '#1e40af'
},
borderRadius: {
'none': '0px',
'sm': '4px',
DEFAULT: '8px',
'md': '12px',
'lg': '16px',
'xl': '20px',
'2xl': '24px',
'3xl': '32px',
'full': '9999px',
'button': '8px'
}
}
}
}
</script>
<style>
:where([class^="ri-"])::before {
content: "\f3c2";
}
</style>
</head>
<body class="min-h-screen">
<!-- 顶部标题区域 -->
<div class="relative overflow-hidden">
<div class="absolute inset-0">
<img src="./figure/卫星地球图像.jpg"
class="w-full h-full object-cover opacity-20" alt="背景">
</div>
<div class="max-w-7xl mx-auto px-6 py-12 relative">
<h1 class="text-4xl font-bold text-center mb-8 bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-blue-600">
OrbitGuard: 面向航天遥感目标检测模型的可靠性评估与漏洞对抗系统
</h1>
<div class="absolute -top-20 -left-20 w-40 h-40 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob"></div>
<div class="absolute -top-20 -right-20 w-40 h-40 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-20 animate-blob animation-delay-2000"></div>
<!-- YOLO模型流程图区域 -->
<div class="tech-card tech-border rounded-xl p-8 mb-8 tech-glow">
<h2 class="text-2xl font-semibold text-center text-blue-400 mb-6">YOLO 模型流程图</h2>
<div class="bg-[rgba(255,255,255,0.03)] rounded-xl p-6 backdrop-blur-sm border border-[rgba(255,255,255,0.1)]">
<img src="./figure/系统流程图.jpg"
alt="YOLO模型流程图"
class="w-full h-64 object-contain rounded-lg">
</div>
</div>
<!-- 模型下载区域 -->
<div class="text-center">
<div class="inline-flex items-center gap-4">
<span class="text-lg text-gray-700">下载 yolov8.pt 文件：</span>
<button id="downloadBtn" class="bg-primary text-white px-6 py-3 !rounded-button hover:bg-blue-600 transition-colors whitespace-nowrap inline-flex items-center gap-2">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-download-line"></i>
</div>
下载
</button>
</div>
</div>
</div>
</div>
<!-- 功能模块区域 -->
<div class="max-w-7xl mx-auto px-6 py-12">
<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
<!-- 场景一 -->
<div class="tech-card tech-border rounded-xl p-8 transform hover:scale-105 transition-transform duration-300 backdrop-blur-md bg-white/5 hover:border-blue-400 transition-colors">
<div class="absolute top-4 right-4">
<div class="w-8 h-8 flex items-center justify-center">
<i class="ri-radar-line text-blue-400"></i>
</div>
</div>
<h3 class="text-xl font-semibold text-blue-400 mb-6 text-center">卫星图像对抗样本检测</h3>
<div class="mb-8">
<p class="text-gray-300 leading-relaxed mb-4">
对抗样本攻击检测算法，通过在原始图像中添加微小的扰动，生成能够欺骗深度学习模型的对抗样本。
</p>
<p class="text-gray-400 leading-relaxed">
<strong class="text-blue-300">测试算法的创新点：</strong>采用梯度引导的扰动生成方法，能够在保持视觉不可察觉的前提下，有效降低目标检测模型的准确率。
</p>
</div>
<div class="flex gap-4 justify-center">
<button class="scenario-detect-btn bg-primary text-white px-6 py-3 !rounded-button hover:bg-blue-600 transition-colors whitespace-nowrap" data-scenario="1">
检测
</button>
<button class="scenario-repair-btn bg-green-600 text-white px-6 py-3 !rounded-button hover:bg-green-700 transition-colors whitespace-nowrap" data-scenario="1">
修复
</button>
<!-- 在每个场景按钮部分添加漏洞触发按钮 -->
<button class="scenario-trigger-btn bg-red-600 text-white px-6 py-3 !rounded-button hover:bg-red-700 transition-colors whitespace-nowrap" data-scenario="1">
  漏洞触发
</button>

</div>
</div>
<!-- 场景二 -->
<div class="tech-card tech-border rounded-xl p-8 transform hover:scale-105 transition-transform duration-300 backdrop-blur-md bg-white/5 hover:border-blue-400 transition-colors">
<div class="absolute top-4 right-4">
<div class="w-8 h-8 flex items-center justify-center">
<i class="ri-shield-flash-line text-blue-400"></i>
</div>
</div>
<h3 class="text-xl font-semibold text-blue-400 mb-6 text-center">位翻转攻击检测</h3>
<div class="mb-8">
<p class="text-gray-300 leading-relaxed mb-4">
模型参数位翻转攻击检测，通过翻转神经网络权重参数的特定位，模拟硬件故障对模型推理的影响。
</p>
<p class="text-gray-400 leading-relaxed">
<strong class="text-blue-300">测试算法的创新点：</strong>基于重要性评分的位翻转策略，能够精确定位对模型性能影响最大的关键参数位置。
</p>
</div>
<div class="flex gap-4 justify-center">
<button class="scenario-detect-btn bg-primary text-white px-6 py-3 !rounded-button hover:bg-blue-600 transition-colors whitespace-nowrap" data-scenario="2">
检测
</button>
<button class="scenario-repair-btn bg-green-600 text-white px-6 py-3 !rounded-button hover:bg-green-700 transition-colors whitespace-nowrap" data-scenario="2">
修复
</button>
<!-- 在每个场景按钮部分添加漏洞触发按钮 -->
<button class="scenario-trigger-btn bg-red-600 text-white px-6 py-3 !rounded-button hover:bg-red-700 transition-colors whitespace-nowrap" data-scenario="1">
  漏洞触发
</button>

</div>
</div>
<!-- 场景三 -->
<div class="tech-card tech-border rounded-xl p-8 transform hover:scale-105 transition-transform duration-300 backdrop-blur-md bg-white/5 hover:border-blue-400 transition-colors">
<div class="absolute top-4 right-4">
<div class="w-8 h-8 flex items-center justify-center">
<i class="ri-timer-flash-line text-blue-400"></i>
</div>
</div>
<h3 class="text-xl font-semibold text-blue-400 mb-6 text-center">推理时间延迟攻击检测</h3>
<div class="mb-8">
<p class="text-gray-300 leading-relaxed mb-4">
推理时间延迟攻击检测，通过注入计算复杂度高的恶意样本，导致模型推理时间显著增加。
</p>
<p class="text-gray-400 leading-relaxed">
<strong class="text-blue-300">测试算法的创新点：</strong>结合时间复杂度分析和资源消耗监控，能够识别并量化推理延迟攻击的严重程度。
</p>
</div>
<div class="flex gap-4 justify-center">
<button class="scenario-detect-btn bg-primary text-white px-6 py-3 !rounded-button hover:bg-blue-600 transition-colors whitespace-nowrap" data-scenario="3">
检测
</button>
<button class="scenario-repair-btn bg-green-600 text-white px-6 py-3 !rounded-button hover:bg-green-700 transition-colors whitespace-nowrap" data-scenario="3">
修复
</button>
<!-- 在每个场景按钮部分添加漏洞触发按钮 -->
<button class="scenario-trigger-btn bg-red-600 text-white px-6 py-3 !rounded-button hover:bg-red-700 transition-colors whitespace-nowrap" data-scenario="1">
  漏洞触发
</button>

</div>
</div>
</div>
</div>
<!-- 检测结果弹窗 -->
<div id="detectModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
<div class="bg-white rounded-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
<div class="p-8">
<div class="flex justify-between items-center mb-6">
<h3 id="detectModalTitle" class="text-2xl font-semibold text-gray-900">检测结果</h3>
<button id="closeDetectModal" class="text-gray-500 hover:text-gray-700">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-close-line ri-lg"></i>
</div>
</button>
</div>
<div id="detectModalContent" class="text-gray-700">
<!-- 动态内容 -->
</div>
</div>
</div>
</div>
<!-- 修复结果弹窗 -->
<div id="repairModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
<div class="bg-white rounded-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
<div class="p-8">
<div class="flex justify-between items-center mb-6">
<h3 id="repairModalTitle" class="text-2xl font-semibold text-gray-900">修复结果</h3>
<button id="closeRepairModal" class="text-gray-500 hover:text-gray-700">
<div class="w-6 h-6 flex items-center justify-center">
<i class="ri-close-line ri-lg"></i>
</div>
</button>
</div>
<div id="repairModalContent" class="text-gray-700">
<!-- 动态内容 -->
</div>
</div>
</div>
</div>
<script id="download-handler">
document.addEventListener('DOMContentLoaded', function() {
const downloadBtn = document.getElementById('downloadBtn');
downloadBtn.addEventListener('click', function() {
// 模拟文件下载
const link = document.createElement('a');
link.href = '#';
link.download = 'yolov8.pt';
link.textContent = 'yolov8.pt';
// 创建临时提示
const originalText = downloadBtn.innerHTML;
downloadBtn.innerHTML = '<div class="w-5 h-5 flex items-center justify-center"><i class="ri-check-line"></i></div>下载中...';
downloadBtn.disabled = true;
setTimeout(() => {
downloadBtn.innerHTML = originalText;
downloadBtn.disabled = false;
alert('yolov8.pt 文件下载完成！');
}, 2000);
});
});
</script>
<script id="modal-handlers">
document.addEventListener('DOMContentLoaded', function() {
const detectModal = document.getElementById('detectModal');
const repairModal = document.getElementById('repairModal');
const closeDetectModal = document.getElementById('closeDetectModal');
const closeRepairModal = document.getElementById('closeRepairModal');
// 关闭弹窗事件
closeDetectModal.addEventListener('click', () => {
detectModal.classList.add('hidden');
});
closeRepairModal.addEventListener('click', () => {
repairModal.classList.add('hidden');
});
// 点击背景关闭弹窗
detectModal.addEventListener('click', (e) => {
if (e.target === detectModal) {
detectModal.classList.add('hidden');
}
});
repairModal.addEventListener('click', (e) => {
if (e.target === repairModal) {
repairModal.classList.add('hidden');
}
});
});
</script>
<script id="scenario-handlers">
document.addEventListener('DOMContentLoaded', function() {
const detectBtns = document.querySelectorAll('.scenario-detect-btn');
const repairBtns = document.querySelectorAll('.scenario-repair-btn');
// 检测按钮事件
detectBtns.forEach(btn => {
btn.addEventListener('click', function() {
const scenario = this.getAttribute('data-scenario');
showDetectResult(scenario);
});
});
// 修复按钮事件
repairBtns.forEach(btn => {
btn.addEventListener('click', function() {
const scenario = this.getAttribute('data-scenario');
showRepairResult(scenario);
});
});
function showDetectResult(scenario) {
const modal = document.getElementById('detectModal');
const title = document.getElementById('detectModalTitle');
const content = document.getElementById('detectModalContent');
title.textContent = `场景${scenario}检测结果`;
if (scenario === '1') {
// 场景1：对抗样本干扰可视化
content.innerHTML = `
<div class="space-y-6">
<div class="bg-blue-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-blue-900">对抗样本干扰可视化</h4>
<div class="grid grid-cols-2 gap-6">
<div>
<p class="text-sm text-gray-600 mb-2">原始图像</p>
<img src="https://readdy.ai/api/search-image?query=satellite%20remote%20sensing%20image%20of%20urban%20area%20with%20clear%20buildings%20and%20roads%2C%20high%20resolution%20aerial%20view%2C%20clean%20background&width=300&height=200&seq=original_image&orientation=landscape"
alt="原始图像" class="w-full rounded-lg border">
</div>
<div>
<p class="text-sm text-gray-600 mb-2">对抗样本</p>
<img src="https://readdy.ai/api/search-image?query=satellite%20remote%20sensing%20image%20with%20subtle%20adversarial%20noise%20perturbations%2C%20slightly%20distorted%20but%20visually%20similar%20to%20original%2C%20technical%20visualization&width=300&height=200&seq=adversarial_image&orientation=landscape"
alt="对抗样本" class="w-full rounded-lg border">
</div>
</div>
</div>
<div class="bg-red-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-red-900">攻击效果分析</h4>
<div class="grid grid-cols-2 gap-6">
<div>
<p class="text-sm text-gray-600">扰动强度：<span class="font-semibold">ε = 0.031</span></p>
<p class="text-sm text-gray-600">检测精度下降：<span class="font-semibold text-red-600">23.5%</span></p>
</div>
<div>
<p class="text-sm text-gray-600">成功攻击率：<span class="font-semibold text-red-600">87.3%</span></p>
<p class="text-sm text-gray-600">视觉不可察觉性：<span class="font-semibold">SSIM = 0.98</span></p>
</div>
</div>
</div>
</div>
`;
} else {
// 场景2和3：数据结果
const data = scenario === '2' ? {
title: '位翻转攻击检测结果',
flipCount: '127',
positions: ['Layer 3, Weight[245,67]', 'Layer 7, Bias[12]', 'Layer 11, Weight[89,156]'],
accuracyDrop: '15.8%',
timeIncrease: '2.3ms'
} : {
title: '推理延迟攻击检测结果',
flipCount: '89',
positions: ['Layer 5, Weight[123,45]', 'Layer 9, Bias[78]', 'Layer 13, Weight[234,89]'],
accuracyDrop: '12.4%',
timeIncrease: '45.7ms'
};
content.innerHTML = `
<div class="space-y-6">
<div class="bg-yellow-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-yellow-900">${data.title}</h4>
<div class="grid grid-cols-2 gap-6">
<div>
<p class="text-sm text-gray-600 mb-2">位翻转次数</p>
<p class="text-2xl font-bold text-yellow-700">${data.flipCount}</p>
</div>
<div>
<p class="text-sm text-gray-600 mb-2">模型精度下降</p>
<p class="text-2xl font-bold text-red-600">${data.accuracyDrop}</p>
</div>
</div>
</div>
<div class="bg-gray-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4">位翻转具体位置</h4>
<ul class="space-y-2">
${data.positions.map(pos => `<li class="text-sm text-gray-700 bg-white p-2 rounded border-l-4 border-blue-400">${pos}</li>`).join('')}
</ul>
</div>
<div class="bg-orange-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-orange-900">性能影响分析</h4>
<div class="grid grid-cols-2 gap-6">
<div>
<p class="text-sm text-gray-600">推理时间延长</p>
<p class="text-xl font-bold text-orange-700">${data.timeIncrease}</p>
</div>
<div>
<p class="text-sm text-gray-600">内存占用增加</p>
<p class="text-xl font-bold text-orange-700">8.5MB</p>
</div>
</div>
</div>
</div>
`;
}
modal.classList.remove('hidden');
}
function showRepairResult(scenario) {
const modal = document.getElementById('repairModal');
const title = document.getElementById('repairModalTitle');
const content = document.getElementById('repairModalContent');
function handleRepairedModelDownload() {
const downloadBtn = document.getElementById('downloadRepairedModelBtn');
const reportBtn = document.getElementById('downloadReportBtn');
if (!downloadBtn || !reportBtn) return;
downloadBtn.addEventListener('click', function() {
const link = document.createElement('a');
link.href = '#';
link.download = 'yolov8_repaired.pt';
const originalContent = this.innerHTML;
this.innerHTML = `
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-loader-4-line animate-spin"></i>
</div>
下载中...
`;
this.disabled = true;
setTimeout(() => {
this.innerHTML = originalContent;
this.disabled = false;
const notification = document.createElement('div');
notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
notification.innerHTML = '修复后模型下载完成！';
document.body.appendChild(notification);
setTimeout(() => {
notification.remove();
}, 3000);
}, 2000);
});
reportBtn.addEventListener('click', function() {
const originalContent = this.innerHTML;
this.innerHTML = `
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-loader-4-line animate-spin"></i>
</div>
下载中...
`;
this.disabled = true;
const currentDate = new Date().toISOString().split('T')[0];
const reportContent = `
修复报告
生成日期: ${currentDate}
1. 修复概述
- 修复前精度: ${document.querySelector('.text-red-600').textContent}
- 修复后精度: ${document.querySelector('.text-green-600').textContent}
- 性能提升: ${document.querySelector('.text-blue-600').textContent}
2. 修复方法
${document.querySelector('.border-l-4.border-blue-400').textContent}
3. 技术细节
- 模型架构: YOLOv8
- 优化方案: 对抗训练 + 特征去噪
- 计算资源消耗: GPU利用率降低15%
- 内存占用优化: 减少25%
4. 性能评估
- 推理速度: 提升30%
- 准确率: 提升17.7%
- 鲁棒性: 提升45%
5. 建议
- 定期进行模型健康检查
- 持续监控性能指标
- 及时更新防御策略
`;
const blob = new Blob([reportContent], { type: 'text/plain' });
const url = window.URL.createObjectURL(blob);
const link = document.createElement('a');
link.href = url;
link.download = `repair_report_${currentDate}.txt`;
setTimeout(() => {
link.click();
window.URL.revokeObjectURL(url);
this.innerHTML = originalContent;
this.disabled = false;
const notification = document.createElement('div');
notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-fade-in';
notification.innerHTML = '修复报告下载完成！';
document.body.appendChild(notification);
setTimeout(() => {
notification.remove();
}, 3000);
}, 2000);
});
}
setTimeout(() => {
handleRepairedModelDownload();
}, 100);
title.textContent = `场景${scenario}修复结果`;
const repairData = {
'1': {
title: '对抗样本防御修复',
beforeAccuracy: '76.5%',
afterAccuracy: '94.2%',
improvement: '17.7%',
method: '对抗训练 + 特征去噪'
},
'2': {
title: '位翻转错误修复',
beforeAccuracy: '84.2%',
afterAccuracy: '98.7%',
improvement: '14.5%',
method: '错误检测纠正 + 冗余校验'
},
'3': {
title: '推理延迟优化修复',
beforeAccuracy: '87.6%',
afterAccuracy: '97.3%',
improvement: '9.7%',
method: '计算图优化 + 资源调度'
}
};
const data = repairData[scenario];
content.innerHTML = `
<div class="space-y-6">
<div class="bg-green-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-green-900">${data.title}</h4>
<div class="grid grid-cols-3 gap-6">
<div class="text-center">
<p class="text-sm text-gray-600 mb-2">修复前精度</p>
<p class="text-2xl font-bold text-red-600">${data.beforeAccuracy}</p>
</div>
<div class="text-center">
<p class="text-sm text-gray-600 mb-2">修复后精度</p>
<p class="text-2xl font-bold text-green-600">${data.afterAccuracy}</p>
</div>
<div class="text-center">
<p class="text-sm text-gray-600 mb-2">性能提升</p>
<p class="text-2xl font-bold text-blue-600">+${data.improvement}</p>
</div>
</div>
</div>
<div class="bg-blue-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4 text-blue-900">修复方法</h4>
<p class="text-gray-700 bg-white p-4 rounded border-l-4 border-blue-400">${data.method}</p>
</div>
<div class="bg-gray-50 p-6 rounded-lg">
<h4 class="text-lg font-semibold mb-4">修复后模型下载</h4>
<div class="flex gap-4">
<button id="downloadRepairedModelBtn" class="bg-primary text-white px-6 py-3 !rounded-button hover:bg-blue-600 transition-colors whitespace-nowrap inline-flex items-center gap-2">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-download-line"></i>
</div>
下载修复后模型
</button>
<button id="downloadReportBtn" class="bg-gray-600 text-white px-6 py-3 !rounded-button hover:bg-gray-700 transition-colors whitespace-nowrap inline-flex items-center gap-2">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-file-text-line"></i>
</div>
下载修复报告
</button>
</div>
</div>
</div>
`;
modal.classList.remove('hidden');
}
});
</script>
<!-- 漏洞传播路径可视化 -->
<div class="max-w-4xl mx-auto px-6 py-12">
  <div class="rounded-xl p-8 border border-white/10 backdrop-blur-sm bg-white/5">
    <h2 class="text-2xl font-semibold text-center text-blue-400 mb-6">漏洞传播路径可视化</h2>
    <div class="flex flex-col items-center gap-6">
      <div id="networkVisualization" class="w-full h-[400px] relative rounded-xl p-4 border border-white/10 bg-white/5 backdrop-blur-sm">
        <svg id="networkSvg" class="w-full h-full"></svg>
      </div>
      <button id="startVisualization" class="bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600 transition">
        <i class="ri-play-line mr-2"></i>开始演示
      </button>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
//   const svg = document.getElementById('networkSvg');
//   const width = svg.clientWidth * 0.7;
//   const height = svg.clientHeight * 0.7; // 保持高度的80%用于可视化
  const svg = document.getElementById('networkSvg');
  const width = 850;  // 增加宽度
  const height = 370; // 增加高度

  // 设置 SVG 的宽度和高度
  svg.setAttribute('width', width);
  svg.setAttribute('height', height);

const layers = [
  { nodes: 3, x: width * 0.05 },  // Input Layer
  { nodes: 4, x: width * 0.15 },
  { nodes: 5, x: width * 0.25 },
  { nodes: 6, x: width * 0.35 },
  { nodes: 6, x: width * 0.45 },
  { nodes: 6, x: width * 0.55 },   // Hidden Layer 2
  { nodes: 5, x: width * 0.65 },   // Hidden Layer 3
  { nodes: 4, x: width * 0.75 },  // Hidden Layer 4
  { nodes: 2, x: width * 0.85 }   // Output Layer
];



  const nodeRadius = 15;
  const normalColor = 'rgba(255, 255, 255, 0.9)';
  const vulnerableColor = '#ff4444';
  const lineColor = 'rgba(100, 100, 100, 0.3)';
  const vulnerableLineColor = 'rgba(255, 0, 0, 0.5)';

  let nodes = [], connections = [];

  function createSvgElement(tag, attrs) {
    const el = document.createElementNS('http://www.w3.org/2000/svg', tag);
    for (const [k, v] of Object.entries(attrs)) el.setAttribute(k, v);
    return el;
  }

  function createNode(x, y, layer, index) {
    const g = createSvgElement('g', { transform: `translate(${x},${y})` });
    const outer = createSvgElement('circle', {
      r: nodeRadius, fill: normalColor, stroke: '#666', 'stroke-width': 2
    });
    const inner = createSvgElement('circle', {
      r: nodeRadius * 0.7, fill: 'white'
    });
    g.appendChild(outer);
    g.appendChild(inner);
    svg.appendChild(g);
    return { x, y, layer, index, outer, inner };
  }

  function createConnection(from, to) {
    const line = createSvgElement('line', {
      x1: from.x, y1: from.y, x2: to.x, y2: to.y,
      stroke: lineColor, 'stroke-width': 1
    });
    svg.insertBefore(line, svg.firstChild);
    return { from, to, line };
  }

  function initializeNetwork() {
    layers.forEach((layer, layerIndex) => {
      const layerNodes = [];
      const offsetY = (height - (layer.nodes - 1) * 60) / 2;
      for (let i = 0; i < layer.nodes; i++) {
        const node = createNode(layer.x, offsetY + i * 60, layerIndex, i);
        layerNodes.push(node);
      }
      if (layerIndex > 0) {
        nodes[layerIndex - 1].forEach(from => {
          layerNodes.forEach(to => {
            connections.push(createConnection(from, to));
          });
        });
      }
      nodes.push(layerNodes);
    });
  }

  function resetNetwork() {
    nodes.flat().forEach(n => {
      n.outer.setAttribute('fill', normalColor);
      n.inner.setAttribute('fill', 'white');
    });
    connections.forEach(c => {
      c.line.setAttribute('stroke', lineColor);
      c.line.setAttribute('stroke-width', '1');
    });
  }

  function highlightVulnerabilityPath() {
    resetNetwork();
    let currentLayer = 0;
    const vulnerableNodes = [];

    function animateLayer() {
      if (currentLayer >= nodes.length) return;
      const current = nodes[currentLayer];
      const affected = current.filter(() => Math.random() < 0.6);
      vulnerableNodes[currentLayer] = affected;

      affected.forEach(n => {
        n.outer.setAttribute('fill', vulnerableColor);
        n.inner.setAttribute('fill', '#ffcccc');
      });

      if (currentLayer > 0) {
        connections.forEach(conn => {
          if (vulnerableNodes[conn.from.layer]?.includes(conn.from) &&
              vulnerableNodes[conn.to.layer]?.includes(conn.to)) {
            conn.line.setAttribute('stroke', vulnerableLineColor);
            conn.line.setAttribute('stroke-width', '2');
          }
        });
      }

      currentLayer++;
      setTimeout(animateLayer, 500);
    }

    animateLayer();
  }

  initializeNetwork();

  document.getElementById('startVisualization').addEventListener('click', function () {
    this.disabled = true;
    this.innerHTML = `<i class="ri-loader-4-line animate-spin mr-2"></i>演示中...`;
    highlightVulnerabilityPath();
    setTimeout(() => {
      this.disabled = false;
      this.innerHTML = `<i class="ri-play-line mr-2"></i>开始演示`;
    }, nodes.length * 500 + 500);
  });
});
</script>
</body>
</html>